"use strict";var _createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var DraggableObject=function(){function n(t,e){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,n),this.element=t,this.dragged=!1,this.size=this.setSize(t),this.placement=this.getPlacement(t),this.parent=this.setParent(t),this.initialPosition=this.getPosition(t),this.currentPosition=this.getPosition(t),this.actions=this.setActionsData(e),this.droppable=i,this.draggable()}return _createClass(n,[{key:"setSize",value:function(t){return{width:t.offsetWidth,height:t.offsetHeight}}},{key:"getPosition",value:function(t){return{top:t.offsetTop,left:t.offsetLeft}}},{key:"setPosition",value:function(t){this.currentPosition={top:t.top,left:t.left},this.element.style.top=t.top+"px",this.element.style.left=t.left+"px",this.debug&&this.debugMode(t)}},{key:"getPlacement",value:function(t){var e=t.getBoundingClientRect();return{top:e.top+window.scrollY,right:e.left+window.scrollX+t.offsetWidth,left:e.left+window.scrollX,bottom:e.top+window.scrollY+t.offsetHeight}}},{key:"setParent",value:function(t){var e=t.parentElement;return{element:e,size:this.setSize(e),position:this.getPosition(e),placement:this.getPlacement(e)}}},{key:"setActionsData",value:function(t){var e=[];return t.forEach(function(t){e.push({element:t.element,placement:this.getPlacement(t.element),callback:t.callback})}.bind(this)),e}},{key:"setDragged",value:function(t){this.dragged=t,this.element.setAttribute("dragged",t)}},{key:"draggable",value:function(){this.element.addEventListener("mousedown",this.onDrag.bind(this)),this.element.addEventListener("mouseup",this.onDrop.bind(this)),this.droppable||this.element.addEventListener("mousemove",this.onDragAndHover.bind(this)),this.parent.element.addEventListener("mousemove",this.move.bind(this)),this.parent.element.addEventListener("mouseleave",this.onDropOut.bind(this)),this.debug&&this.debugMode(this.position)}},{key:"onDrag",value:function(){this.setDragged(!0)}},{key:"onDrop",value:function(){this.dragged&&(this.setDragged(!1),this.droppable&&0<this.actions.length&&this.doActions())}},{key:"onDropOut",value:function(){this.dragged&&(this.setPosition({top:this.initialPosition.top,left:this.initialPosition.left}),this.setDragged(!1))}},{key:"onDragAndHover",value:function(){this.dragged&&0<this.actions.length&&this.doActions()&&this.setDragged(!1)}},{key:"move",value:function(t){var e,i,n;this.dragged&&(e=t.clientY+window.scrollY,i=t.clientX+window.scrollX,(n={top:e-this.parent.placement.top-this.size.height/2,left:i-this.parent.placement.left-this.size.width/2}).top<=0&&(n.top=0),n.left<=0&&(n.left=0),n.left>=this.parent.size.width-this.size.width&&(n.left=this.parent.size.width-this.size.width),n.top>=this.parent.size.height-this.size.height&&(n.top=this.parent.size.height-this.size.height),this.setPosition(n))}},{key:"doActions",value:function(){var e=!1;return this.actions.forEach(function(t){this.elementIn(t.placement)&&(t.callback(),e=!0)}.bind(this)),e}},{key:"elementIn",value:function(t){var e=window.event.clientY+window.scrollY,i=window.event.clientX+window.scrollX;return e>t.top&&e<t.bottom&&i>t.left&&i<t.right}},{key:"enableDebugMode",value:function(){this.debug=!0,this.draggable()}},{key:"debugMode",value:function(t){var e=0<arguments.length&&void 0!==t&&t;e=e||this.getPosition(this.element);var i=document.getElementById("guide-line-y"),n=document.getElementById("guide-line-x");i||n||((i=document.createElement("div")).setAttribute("id","guide-line-y"),i.style.cssText="width:100%;height:0;border-bottom:1px dotted red;position:absolute;top:0;left:0;z-index:1;",(n=document.createElement("div")).setAttribute("id","guide-line-x"),n.style.cssText="width:0;height:100%;border-right:1px dotted red;position:absolute;top:0;left:0;z-index:1;",this.parent.element.appendChild(i),this.parent.element.appendChild(n)),i.style.top=e.top+this.size.height/2+"px",n.style.left=e.left+this.size.width/2+"px"}}]),n}();